module.exports = class Data1677796788412 {
    name = 'Data1677796788412'

    async up(db) {
        await db.query(`CREATE TABLE "transfer" ("id" character varying NOT NULL, "block_height" integer NOT NULL, "block_hash" text NOT NULL, "timestamp" TIMESTAMP WITH TIME ZONE NOT NULL, "amount" numeric NOT NULL, "currency" text, "address_chain_prefix" text NOT NULL, "from_id" character varying, "to_id" character varying, CONSTRAINT "PK_fd9ddbdd49a17afcbe014401295" PRIMARY KEY ("id"))`)
        await db.query(`CREATE INDEX "IDX_76bdfed1a7eb27c6d8ecbb7349" ON "transfer" ("from_id") `)
        await db.query(`CREATE INDEX "IDX_0751309c66e97eac9ef1149362" ON "transfer" ("to_id") `)
        await db.query(`CREATE TABLE "username_registration_order" ("id" character varying NOT NULL, "block_hash_seller_chain" text, "block_hash_uname_host_chain" text, "confirmed_block_hash_seller_chain" text, "confirmed_remark_call_id" text, "price" numeric NOT NULL, "currency" text NOT NULL, "status" character varying(10), "refund_status" character varying(9), "purchase_rmrk" jsonb, "confirmation_rmrk" jsonb, "refund_rmrk" jsonb, "error" jsonb, "registrant_id" character varying, "username_id" character varying, "purchase_tx_id" character varying, "refund_tx_id" character varying, CONSTRAINT "PK_0ab950366809b89de20111ae473" PRIMARY KEY ("id"))`)
        await db.query(`CREATE INDEX "IDX_aa459a63c7c63567d5141dd77f" ON "username_registration_order" ("registrant_id") `)
        await db.query(`CREATE INDEX "IDX_4204a84aeabe6afbc6ac3d0625" ON "username_registration_order" ("username_id") `)
        await db.query(`CREATE INDEX "IDX_e14d4ea1cfec6dcdf317098e35" ON "username_registration_order" ("purchase_tx_id") `)
        await db.query(`CREATE INDEX "IDX_6f5e3dfad98241f574ff481d3a" ON "username_registration_order" ("refund_tx_id") `)
        await db.query(`CREATE TABLE "energy_box" ("id" character varying NOT NULL, "block_hash_seller_chain" text, "block_hash_energy_host_chain" text, "energy_amount" numeric NOT NULL, "box_price" numeric NOT NULL, "currency" text NOT NULL, "status" character varying(10), "refund_status" character varying(9), "generation_rmrk" jsonb, "confirmation_rmrk" jsonb, "refund_rmrk" jsonb, "owner_id" character varying, "purchase_tx_id" character varying, "refund_tx_id" character varying, CONSTRAINT "PK_b3c52bb9654ab46dab275c806c6" PRIMARY KEY ("id"))`)
        await db.query(`CREATE INDEX "IDX_d4663815e8ad21cf78db938549" ON "energy_box" ("owner_id") `)
        await db.query(`CREATE INDEX "IDX_6a7313614d71594cbc720bec55" ON "energy_box" ("purchase_tx_id") `)
        await db.query(`CREATE INDEX "IDX_05b6986250015fd1d92647ff0c" ON "energy_box" ("refund_tx_id") `)
        await db.query(`CREATE TABLE "account" ("id" character varying NOT NULL, CONSTRAINT "PK_54115ee388cdb6d86bb4bf5b2ea" PRIMARY KEY ("id"))`)
        await db.query(`CREATE TABLE "username" ("id" character varying NOT NULL, "created_at" TIMESTAMP WITH TIME ZONE, "created_at_block" integer, "owner_id" character varying, CONSTRAINT "PK_fd8e31cc54a22af809d3fbf587b" PRIMARY KEY ("id"))`)
        await db.query(`CREATE INDEX "IDX_07480b7d54ba6ed50c50ebb05f" ON "username" ("owner_id") `)
        await db.query(`ALTER TABLE "transfer" ADD CONSTRAINT "FK_76bdfed1a7eb27c6d8ecbb73496" FOREIGN KEY ("from_id") REFERENCES "account"("id") ON DELETE NO ACTION ON UPDATE NO ACTION`)
        await db.query(`ALTER TABLE "transfer" ADD CONSTRAINT "FK_0751309c66e97eac9ef11493623" FOREIGN KEY ("to_id") REFERENCES "account"("id") ON DELETE NO ACTION ON UPDATE NO ACTION`)
        await db.query(`ALTER TABLE "username_registration_order" ADD CONSTRAINT "FK_aa459a63c7c63567d5141dd77fa" FOREIGN KEY ("registrant_id") REFERENCES "account"("id") ON DELETE NO ACTION ON UPDATE NO ACTION`)
        await db.query(`ALTER TABLE "username_registration_order" ADD CONSTRAINT "FK_4204a84aeabe6afbc6ac3d06252" FOREIGN KEY ("username_id") REFERENCES "username"("id") ON DELETE NO ACTION ON UPDATE NO ACTION`)
        await db.query(`ALTER TABLE "username_registration_order" ADD CONSTRAINT "FK_e14d4ea1cfec6dcdf317098e35f" FOREIGN KEY ("purchase_tx_id") REFERENCES "transfer"("id") ON DELETE NO ACTION ON UPDATE NO ACTION`)
        await db.query(`ALTER TABLE "username_registration_order" ADD CONSTRAINT "FK_6f5e3dfad98241f574ff481d3a2" FOREIGN KEY ("refund_tx_id") REFERENCES "transfer"("id") ON DELETE NO ACTION ON UPDATE NO ACTION`)
        await db.query(`ALTER TABLE "energy_box" ADD CONSTRAINT "FK_d4663815e8ad21cf78db9385494" FOREIGN KEY ("owner_id") REFERENCES "account"("id") ON DELETE NO ACTION ON UPDATE NO ACTION`)
        await db.query(`ALTER TABLE "energy_box" ADD CONSTRAINT "FK_6a7313614d71594cbc720bec55f" FOREIGN KEY ("purchase_tx_id") REFERENCES "transfer"("id") ON DELETE NO ACTION ON UPDATE NO ACTION`)
        await db.query(`ALTER TABLE "energy_box" ADD CONSTRAINT "FK_05b6986250015fd1d92647ff0c7" FOREIGN KEY ("refund_tx_id") REFERENCES "transfer"("id") ON DELETE NO ACTION ON UPDATE NO ACTION`)
        await db.query(`ALTER TABLE "username" ADD CONSTRAINT "FK_07480b7d54ba6ed50c50ebb05ff" FOREIGN KEY ("owner_id") REFERENCES "account"("id") ON DELETE NO ACTION ON UPDATE NO ACTION`)
    }

    async down(db) {
        await db.query(`DROP TABLE "transfer"`)
        await db.query(`DROP INDEX "public"."IDX_76bdfed1a7eb27c6d8ecbb7349"`)
        await db.query(`DROP INDEX "public"."IDX_0751309c66e97eac9ef1149362"`)
        await db.query(`DROP TABLE "username_registration_order"`)
        await db.query(`DROP INDEX "public"."IDX_aa459a63c7c63567d5141dd77f"`)
        await db.query(`DROP INDEX "public"."IDX_4204a84aeabe6afbc6ac3d0625"`)
        await db.query(`DROP INDEX "public"."IDX_e14d4ea1cfec6dcdf317098e35"`)
        await db.query(`DROP INDEX "public"."IDX_6f5e3dfad98241f574ff481d3a"`)
        await db.query(`DROP TABLE "energy_box"`)
        await db.query(`DROP INDEX "public"."IDX_d4663815e8ad21cf78db938549"`)
        await db.query(`DROP INDEX "public"."IDX_6a7313614d71594cbc720bec55"`)
        await db.query(`DROP INDEX "public"."IDX_05b6986250015fd1d92647ff0c"`)
        await db.query(`DROP TABLE "account"`)
        await db.query(`DROP TABLE "username"`)
        await db.query(`DROP INDEX "public"."IDX_07480b7d54ba6ed50c50ebb05f"`)
        await db.query(`ALTER TABLE "transfer" DROP CONSTRAINT "FK_76bdfed1a7eb27c6d8ecbb73496"`)
        await db.query(`ALTER TABLE "transfer" DROP CONSTRAINT "FK_0751309c66e97eac9ef11493623"`)
        await db.query(`ALTER TABLE "username_registration_order" DROP CONSTRAINT "FK_aa459a63c7c63567d5141dd77fa"`)
        await db.query(`ALTER TABLE "username_registration_order" DROP CONSTRAINT "FK_4204a84aeabe6afbc6ac3d06252"`)
        await db.query(`ALTER TABLE "username_registration_order" DROP CONSTRAINT "FK_e14d4ea1cfec6dcdf317098e35f"`)
        await db.query(`ALTER TABLE "username_registration_order" DROP CONSTRAINT "FK_6f5e3dfad98241f574ff481d3a2"`)
        await db.query(`ALTER TABLE "energy_box" DROP CONSTRAINT "FK_d4663815e8ad21cf78db9385494"`)
        await db.query(`ALTER TABLE "energy_box" DROP CONSTRAINT "FK_6a7313614d71594cbc720bec55f"`)
        await db.query(`ALTER TABLE "energy_box" DROP CONSTRAINT "FK_05b6986250015fd1d92647ff0c7"`)
        await db.query(`ALTER TABLE "username" DROP CONSTRAINT "FK_07480b7d54ba6ed50c50ebb05ff"`)
    }
}
